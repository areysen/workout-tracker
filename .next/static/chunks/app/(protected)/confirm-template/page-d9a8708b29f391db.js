(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{8333:(e,t,s)=>{"use strict";s.d(t,{A:()=>o,AuthProvider:()=>l});var r=s(95155),a=s(12115),n=s(63233);let i=(0,a.createContext)(),l=e=>{let{children:t}=e,[s,l]=(0,a.useState)(void 0),[o,d]=(0,a.useState)(void 0),[c,u]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{n.supabase.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;l(s),d(null!=(t=null==s?void 0:s.user)?t:null)});let{data:{subscription:e}}=n.supabase.auth.onAuthStateChange((e,t)=>{var s;l(t),d(null!=(s=null==t?void 0:t.user)?s:null),(null==t?void 0:t.user)?(async()=>{let{data:e,error:s}=await n.supabase.from("profiles").select("*").eq("user_id",t.user.id).single();s||!e?u(!1):u(!0)})():u(void 0)});return()=>{e.unsubscribe()}},[]),(0,r.jsx)(i.Provider,{value:{user:o,session:s,hasProfile:c,signInWithMagicLink:e=>n.supabase.auth.signInWithOtp({email:e,options:{emailRedirectTo:"".concat(window.location.origin,"/auth-callback")}}),signInWithProvider:e=>n.supabase.auth.signInWithOAuth({provider:e}),signInWithEmailPassword:(e,t)=>n.supabase.auth.signInWithPassword({email:e,password:t}),signUpWithEmailPassword:(e,t)=>n.supabase.auth.signUp({email:e,password:t},{emailRedirectTo:"".concat(window.location.origin,"/auth-callback")}),signOut:()=>n.supabase.auth.signOut()},children:t})},o=()=>(0,a.useContext)(i)},12443:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,dynamic:()=>o});var r=s(95155),a=s(12115),n=s(63233),i=s(8333),l=s(35695);let o="force-dynamic";function d(){let{user:e}=(0,i.A)(),t=(0,l.useRouter)(),[s,o]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[p,m]=(0,a.useState)(null),[h,x]=(0,a.useState)(!1),f=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];(0,a.useEffect)(()=>{if(!(null==e?void 0:e.id))return;let t=async()=>{let{data:t,error:s}=await n.supabase.from("profiles").select("*").eq("user_id",e.id).maybeSingle();t&&m(t)};(async()=>{let{data:t,error:s}=await n.supabase.from("workout_templates").select("*").eq("user_id",e.id).order("day_of_week",{ascending:!0,foreignTable:void 0});s||o((t||[]).sort((e,t)=>f.indexOf(e.day_of_week.toLowerCase())-f.indexOf(t.day_of_week.toLowerCase()))),u(!1)})(),t()},[e]);let b=e=>({warmup:e.warmup||[],main:e.main||[],cooldown:e.cooldown||[]});return d?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#242B2F] text-white",children:"Loading your plan…"}):(0,r.jsxs)("div",{className:"min-h-screen bg-[#242B2F] text-white px-4 py-6 space-y-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center mb-4",children:"Confirm Your Workout Plan"}),s.map(e=>{let t=b(e.exercises||{});return(0,r.jsxs)("details",{className:"bg-[#343E44] rounded-lg p-4 shadow-md ring-1 ring-pink-600/30 transition-all duration-300 hover:scale-[1.01] hover:shadow-pink-500/20 transition-all ease-in-out duration-300",open:!0,children:[(0,r.jsx)("summary",{className:"text-lg font-semibold capitalize cursor-pointer list-none flex justify-between items-center transition-all ease-in-out duration-300",children:(0,r.jsxs)("span",{className:"font-bold text-white",children:[e.day_of_week.charAt(0).toUpperCase()+e.day_of_week.slice(1),": ",e.workout_name]})}),["warmup","main","cooldown"].map(e=>{var s;return(null==(s=t[e])?void 0:s.length)>0&&(0,r.jsxs)("div",{className:"mt-4 border-l-4 pl-3 ".concat("warmup"===e?"border-pink-400":"cooldown"===e?"border-purple-400":"border-white/20"),children:[(0,r.jsx)("h3",{className:"uppercase text-sm font-bold text-gray-300",children:"warmup"===e?"Warmup \uD83D\uDD25":"main"===e?"Main \uD83C\uDFCB️":"Cooldown \uD83E\uDDD8"}),(0,r.jsx)("ul",{className:"mt-1 text-sm space-y-1",children:t[e].map((e,t)=>(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"font-semibold",children:e.name})," –"," ",e.timed?"".concat(e.duration," ⏱"):"".concat(e.sets,"x").concat(e.reps),e.cardio&&(0,r.jsx)("span",{className:"ml-1",children:"❤️"}),e.weighted&&(0,r.jsx)("span",{className:"ml-1",children:"\uD83C\uDFCB️"})]},t))})]},e)})]},e.id||e.day_of_week)}),(0,r.jsxs)("div",{className:"text-center pt-4 flex flex-col items-center",children:[(0,r.jsx)("button",{onClick:()=>t.push("/today"),className:"px-5 py-2 mt-4 rounded-2xl bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:shadow-lg transition-all duration-200 text-white font-semibold",children:"Looks Good!"}),(0,r.jsx)("button",{onClick:()=>x(!0),className:"px-5 py-2 mt-2 rounded-2xl border border-white text-white hover:bg-white hover:text-black font-semibold hover:shadow-lg transition-all duration-200",children:"Edit My Preferences"})]}),h&&(0,r.jsx)(c,{profile:p,setProfile:m,onClose:()=>x(!1),userId:null==e?void 0:e.id,refreshTemplates:()=>{u(!0);let t=async()=>{let{data:t,error:s}=await n.supabase.from("profiles").select("*").eq("user_id",e.id).maybeSingle();t&&m(t)};(async()=>{let{data:t,error:s}=await n.supabase.from("workout_templates").select("*").eq("user_id",e.id).order("day_of_week",{ascending:!0,foreignTable:void 0});s||o((t||[]).sort((e,t)=>f.indexOf(e.day_of_week.toLowerCase())-f.indexOf(t.day_of_week.toLowerCase()))),u(!1)})(),t()}})]})}function c(e){let{profile:t,setProfile:s,onClose:i,userId:l,refreshTemplates:o}=e,[d,c]=(0,a.useState)(t),[u,p]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{c(t)},[t]),!d)return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white text-black p-6 rounded-lg w-11/12 max-w-md",children:[(0,r.jsx)("p",{children:"Loading preferences…"}),(0,r.jsx)("div",{className:"mt-4 flex justify-end",children:(0,r.jsx)("button",{onClick:i,className:"px-4 py-2 rounded-2xl bg-gray-300 text-black hover:bg-gray-400",children:"Close"})})]})});let b=e=>{c(t=>{let s=7-Number(t.days_per_week||0),r=t.preferred_rest_days||[];return r.includes(e)?{...t,preferred_rest_days:r.filter(t=>t!==e)}:r.length>=s?{...t,preferred_rest_days:[...r.slice(1),e]}:{...t,preferred_rest_days:[...r,e]}})},y=async e=>{e.preventDefault(),p(!0),h(null),f(!1);try{let e={...d,user_id:l};"string"==typeof e.days_per_week&&(e.days_per_week=Number(e.days_per_week));let{error:t}=await n.supabase.from("profiles").upsert(e,{onConflict:["user_id"]});if(t){h("Failed to update preferences."),p(!1);return}s(e=>({...e,...d}));let r={name:d.full_name||d.name||"",experience:d.experience,goal:d.goal,days_per_week:d.days_per_week,equipment:d.equipment,height_cm:d.height_cm,weight_kg:d.weight_kg,unit_preference:d.unit_preference,cardio_preference:d.cardio_preference,preferred_rest_days:d.preferred_rest_days||[]},a=await fetch("/api/generate-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok){h("Failed to generate new workout template."),p(!1);return}let c=await a.json(),{error:u}=await n.supabase.from("workout_templates").delete().eq("user_id",l);if(u){h("Failed to delete old templates."),p(!1);return}let m=c.workouts.map(e=>({user_id:l,day_of_week:e.day,workout_name:e.type||e.workout_name||"",exercises:e.exercises,muscle_group:e.muscle_group})),{error:x}=await n.supabase.from("workout_templates").insert(m);if(x){h("Failed to save new templates."),p(!1);return}f(!0),o&&o(),setTimeout(()=>{p(!1),f(!1),i()},1200)}catch(e){h("Something went wrong. Please try again."),p(!1)}},g=7-Number(d.days_per_week||0);return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white text-black p-6 rounded-lg w-11/12 max-w-md",children:[(0,r.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Edit Preferences"}),(0,r.jsxs)("form",{onSubmit:y,className:"mb-4 space-y-3 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"font-semibold block mb-1",children:"Experience Level"}),(0,r.jsxs)("select",{value:d.experience||"",onChange:e=>c(t=>({...t,experience:e.target.value})),className:"w-full px-3 py-2 border rounded",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Experience Level"}),(0,r.jsx)("option",{value:"beginner",children:"Beginner"}),(0,r.jsx)("option",{value:"intermediate",children:"Intermediate"}),(0,r.jsx)("option",{value:"advanced",children:"Advanced"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"font-semibold block mb-1",children:"Primary Goal"}),(0,r.jsxs)("select",{value:d.goal||"",onChange:e=>c(t=>({...t,goal:e.target.value})),className:"w-full px-3 py-2 border rounded",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Goal"}),(0,r.jsx)("option",{value:"fat_loss",children:"Fat Loss"}),(0,r.jsx)("option",{value:"muscle_gain",children:"Muscle Gain"}),(0,r.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,r.jsx)("option",{value:"athletic_performance",children:"Athletic Performance"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"font-semibold block mb-1",children:"Equipment"}),(0,r.jsxs)("select",{value:d.equipment||"",onChange:e=>c(t=>({...t,equipment:e.target.value})),className:"w-full px-3 py-2 border rounded",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Equipment Access"}),(0,r.jsx)("option",{value:"full_gym",children:"Full Gym"}),(0,r.jsx)("option",{value:"dumbbells_only",children:"Dumbbells Only"}),(0,r.jsx)("option",{value:"bodyweight_only",children:"Bodyweight Only"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"font-semibold block mb-1",children:"Cardio Preference"}),(0,r.jsxs)("select",{value:d.cardio_preference||"",onChange:e=>{c(t=>({...t,cardio_preference:e.target.value}))},className:"w-full px-3 py-2 border rounded",required:!0,children:[(0,r.jsx)("option",{value:"none",children:"None (Strength Only)"}),(0,r.jsx)("option",{value:"light",children:"Light (Warmups or Finishers)"}),(0,r.jsx)("option",{value:"moderate",children:"Moderate (1–2 Sessions/Week)"}),(0,r.jsx)("option",{value:"high",children:"High (Daily Conditioning)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"font-semibold block mb-1",children:"Days per Week"}),(0,r.jsx)("input",{type:"number",min:"1",max:"7",value:d.days_per_week||"",onChange:e=>{let t=e.target.value;if(""===t)t="";else{let e=Number(t);t=e<1?"1":e>7?"7":e.toString()}c(e=>({...e,days_per_week:t,preferred_rest_days:e.preferred_rest_days&&Array.isArray(e.preferred_rest_days)?e.preferred_rest_days.slice(0,7-Number(t||0)):[]}))},className:"w-full px-3 py-2 border rounded",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"font-semibold block mb-1",children:"Preferred Rest Days"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].map(e=>{var t,s,a,n;return(0,r.jsx)("button",{type:"button",className:"px-3 py-1 rounded-full ".concat((null==(t=d.preferred_rest_days)?void 0:t.includes(e))?"bg-pink-600 text-white":(null==(s=d.preferred_rest_days)?void 0:s.length)>=g?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-gray-700 text-white"),onClick:()=>b(e),disabled:!(null==(a=d.preferred_rest_days)?void 0:a.includes(e))&&(null==(n=d.preferred_rest_days)?void 0:n.length)>=g,children:e.charAt(0).toUpperCase()+e.slice(1)},e)})}),(0,r.jsxs)("p",{className:"text-gray-600 text-xs mt-1",children:["Select up to ",g," rest day",1!==g?"s":""]})]}),m&&(0,r.jsx)("div",{className:"text-red-600 text-xs",children:m}),x&&(0,r.jsx)("div",{className:"text-green-600 text-xs",children:"Saved! Regenerated your plan."}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-3 mt-4",children:[(0,r.jsx)("button",{type:"button",onClick:i,className:"px-5 py-2 rounded-2xl bg-gray-300 text-black hover:bg-gray-400 font-semibold flex-1",style:{minWidth:"0"},disabled:u,children:"Close"}),(0,r.jsx)("button",{type:"submit",disabled:u,className:"px-5 py-2 rounded-2xl bg-pink-600 hover:bg-pink-700 text-white font-semibold flex-1 whitespace-nowrap min-w-[140px]",style:{minWidth:"0"},children:u?"Saving…":"Save & Regenerate"})]})]})]})})}},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},63233:(e,t,s)=>{"use strict";s.d(t,{DP:()=>a,JI:()=>i,LJ:()=>n,sA:()=>l,supabase:()=>r});let r=(0,s(10851).UU)("https://yfnbnytutxdbmyvfsyba.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbmJueXR1dHhkYm15dmZzeWJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ5MjAwNTksImV4cCI6MjA2MDQ5NjA1OX0.HJhDpx79rDzl5DZIh3qJZbBrSwudG95htPXOs2IGD30",{auth:{persistSession:!0,detectSessionInUrl:!0}}),a=async()=>{let{data:e,error:t}=await r.from("workout_logs").select("*").order("date",{ascending:!0});return t?(console.error("Error fetching workout logs:",t.message),[]):e},n=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,{data:t,error:s}=await r.from("workout_logs").select("date, skipped").order("date",{ascending:!1}).limit(e);return s?(console.error("Error fetching workout logs for last N days:",s.message),[]):t},i=e=>{let t=0;for(let s of e){if(s.skipped)break;t++}return t},l=e=>{let t=0,s=0;for(let r of e)r.skipped?(s>t&&(t=s),s=0):s++;return s>t&&(t=s),t}},92171:(e,t,s)=>{Promise.resolve().then(s.bind(s,12443))}},e=>{var t=t=>e(e.s=t);e.O(0,[851,441,684,358],()=>t(92171)),_N_E=e.O()}]);