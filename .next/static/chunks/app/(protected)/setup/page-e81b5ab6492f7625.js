(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{8333:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,AuthProvider:()=>i});var n=r(95155),a=r(12115),s=r(63233);let l=(0,a.createContext)(),i=e=>{let{children:t}=e,[r,i]=(0,a.useState)(void 0),[o,u]=(0,a.useState)(void 0),[c,d]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{s.supabase.auth.getSession().then(e=>{var t;let{data:{session:r}}=e;i(r),u(null!=(t=null==r?void 0:r.user)?t:null)});let{data:{subscription:e}}=s.supabase.auth.onAuthStateChange((e,t)=>{var r;i(t),u(null!=(r=null==t?void 0:t.user)?r:null),(null==t?void 0:t.user)?(async()=>{let{data:e,error:r}=await s.supabase.from("profiles").select("*").eq("user_id",t.user.id).single();r||!e?d(!1):d(!0)})():d(void 0)});return()=>{e.unsubscribe()}},[]),(0,n.jsx)(l.Provider,{value:{user:o,session:r,hasProfile:c,signInWithMagicLink:e=>s.supabase.auth.signInWithOtp({email:e,options:{emailRedirectTo:"".concat(window.location.origin,"/auth-callback")}}),signInWithProvider:e=>s.supabase.auth.signInWithOAuth({provider:e}),signInWithEmailPassword:(e,t)=>s.supabase.auth.signInWithPassword({email:e,password:t}),signUpWithEmailPassword:(e,t)=>s.supabase.auth.signUp({email:e,password:t},{emailRedirectTo:"".concat(window.location.origin,"/auth-callback")}),signOut:()=>s.supabase.auth.signOut()},children:t})},o=()=>(0,a.useContext)(l)},19433:(e,t,r)=>{"use strict";function n(){let e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(n)}function a(e){let t;if("string"==typeof e){let[r,n,a]=e.split("-").map(Number);t=new Date(r,n-1,a)}else t=e instanceof Date?e:new Date(e);return t.toLocaleDateString("en-US",{weekday:"long"})}function s(e){return new Date(e).toISOString().split("T")[0]}function l(e){let t,{weekday:r="short",month:n="short",day:a="numeric",includeYear:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){let[r,n,a]=e.split("-").map(Number);t=new Date(r,n-1,a)}else if(e instanceof Date)t=e;else throw Error("Invalid date input passed to formatDateWithOptions");return t.toLocaleDateString("en-US",{weekday:r,month:n,day:a,...s&&{year:"numeric"}})}r.d(t,{Gq:()=>n,KG:()=>l,VJ:()=>a,hi:()=>s})},35695:(e,t,r)=>{"use strict";var n=r(18999);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},63233:(e,t,r)=>{"use strict";r.d(t,{DP:()=>a,JI:()=>l,LJ:()=>s,sA:()=>i,supabase:()=>n});let n=(0,r(10851).UU)("https://yfnbnytutxdbmyvfsyba.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbmJueXR1dHhkYm15dmZzeWJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ5MjAwNTksImV4cCI6MjA2MDQ5NjA1OX0.HJhDpx79rDzl5DZIh3qJZbBrSwudG95htPXOs2IGD30",{auth:{persistSession:!0,detectSessionInUrl:!0}}),a=async()=>{let{data:e,error:t}=await n.from("workout_logs").select("*").order("date",{ascending:!0});return t?(console.error("Error fetching workout logs:",t.message),[]):e},s=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,{data:t,error:r}=await n.from("workout_logs").select("date, skipped").order("date",{ascending:!1}).limit(e);return r?(console.error("Error fetching workout logs for last N days:",r.message),[]):t},l=e=>{let t=0;for(let r of e){if(r.skipped)break;t++}return t},i=e=>{let t=0,r=0;for(let n of e)n.skipped?(r>t&&(t=r),r=0):r++;return r>t&&(t=r),t}},84635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h,dynamic:()=>u});var n=r(95155),a=r(12115),s=r(8333),l=r(35695),i=r(63233),o=r(19433);let u="force-dynamic",c=()=>{let e=new Date;return e.setFullYear(e.getFullYear()-13),e.toISOString().split("T")[0]};function d(){let{user:e}=(0,s.A)(),t=(0,l.useRouter)(),[r,u]=(0,a.useState)(""),[d,h]=(0,a.useState)("imperial"),[p,x]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[b,f]=(0,a.useState)(""),[w,y]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[N,S]=(0,a.useState)(""),[k,_]=(0,a.useState)(""),[C,F]=(0,a.useState)(""),[D,I]=(0,a.useState)(""),[B,P]=(0,a.useState)([]),[W,q]=(0,a.useState)(""),[M,O]=(0,a.useState)(!1),[E,A]=(0,a.useState)(1),[L,G]=(0,a.useState)({});(0,a.useEffect)(()=>{(async()=>{if(!(null==e?void 0:e.id))return;let{data:t,error:r}=await i.supabase.from("profiles").select("*").eq("user_id",e.id).maybeSingle();if(t){var n,a,s;if(q(t.full_name||""),u(t.birth_date||""),v(t.experience||""),S(t.goal||""),_((null==(n=t.days_per_week)?void 0:n.toString())||""),F(t.equipment||""),I(t.cardio_preference||""),h(t.unit_preference||"imperial"),P(t.preferred_rest_days||[]),"imperial"===t.unit_preference){let e=Math.round(t.height_cm/2.54);x(Math.floor(e/12).toString()),g((e%12).toString()),y(Math.round(2.20462*t.weight_kg).toString())}else f((null==(a=t.height_cm)?void 0:a.toString())||""),y((null==(s=t.weight_kg)?void 0:s.toString())||"")}r&&console.error("Failed to fetch profile:",r)})()},[e]);let J=e=>{let t=e.target.value,r="imperial"===d?999:453;(""===t||Number(t)<=r)&&y(t)},T=e=>{let t=new Date(e),r=new Date,n=r.getFullYear()-t.getFullYear(),a=r.getMonth()-t.getMonth();return(a<0||0===a&&r.getDate()<t.getDate())&&n--,n},U=(e,t)=>{G(r=>({...r,[e]:r[e]||t}))},R=async e=>{let t=await fetch("/api/generate-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw console.error("Template generation failed:",await t.text()),Error("Failed to generate workout");return await t.json()},Y=async n=>{if(n.preventDefault(),4!==E)return;O(!0);let a="imperial"===d?Math.round((12*Number(p)+Number(m))*2.54):Number(b),s="imperial"===d?Math.round(Number(w)/2.20462):Number(w),{error:l}=await i.supabase.from("profiles").upsert({user_id:e.id,full_name:W,first_name:W.split(" ")[0],birth_date:r,height_cm:a,weight_kg:s,unit_preference:d,experience:j,goal:N,days_per_week:k,equipment:C,cardio_preference:D,preferred_rest_days:B},{onConflict:["user_id"]});if(l){console.error("Error upserting profile:",l),O(!1);return}await i.supabase.auth.updateUser({data:{full_name:W}}),await i.supabase.auth.getSession();try{let t=await R({name:W,experience:j,goal:N,days_per_week:k,equipment:C,height_cm:a,weight_kg:s,unit_preference:d,cardio_preference:D,preferred_rest_days:B});console.log("\uD83C\uDFAF AI Generated Template:",t);let{error:r}=await i.supabase.from("workout_templates").delete().eq("user_id",e.id);if(r){console.error("Failed to delete old templates:",r),O(!1);return}let n=t.workouts.map(t=>({user_id:e.id,day_of_week:t.day,workout_name:t.type,exercises:t.exercises,muscle_group:t.muscle_group})),{error:l}=await i.supabase.from("workout_templates").insert(n);l&&console.error("Failed to save template:",l)}catch(e){console.error("Error generating template:",e)}O(!1),t.push("/confirm-template")},H=()=>1===E?W&&r&&T(r)>=13&&("metric"===d?b:p&&m)&&w:2===E?j&&N:3!==E||k&&C&&D;return(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#242B2F] p-4",children:(0,n.jsxs)("form",{className:"bg-[#343E44] p-6 rounded-lg w-full max-w-sm space-y-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-white text-center",children:"Welcome!"}),(0,n.jsx)("p",{className:"text-gray-400 text-sm",children:"Letâ€™s set you up with your first workout plan."}),1===E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-white text-sm",children:"Step 1: Tell us about you"}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Name"}),(0,n.jsx)("input",{type:"text",placeholder:"Your name",required:!0,value:W,onChange:e=>q(e.target.value),onBlur:()=>U("name",W),className:"text-base w-full px-3 py-2 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.name&&!W?"border border-red-500":"")}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Date of Birth"}),(0,n.jsx)("input",{type:"date",required:!0,value:r,onChange:e=>u(e.target.value),onBlur:()=>U("dob",r),max:c(),className:"text-base w-full px-3 py-2 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.dob&&(!r||13>T(r))?"border border-red-500":"")}),L.dob&&(!r||13>T(r))&&(0,n.jsx)("p",{className:"text-xs text-red-400 mt-1",children:"Must be 13 years or older."}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Preferred Units"}),(0,n.jsxs)("select",{value:d,onChange:e=>h(e.target.value),onBlur:()=>U("unitSystem",d),className:"text-base w-full px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.unitSystem&&!d?"border border-red-500":""),children:[(0,n.jsx)("option",{value:"imperial",children:"Imperial (ft/in)"}),(0,n.jsx)("option",{value:"metric",children:"Metric (cm)"})]}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Height"}),"imperial"===d?(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsxs)("select",{value:p,onChange:e=>x(e.target.value),onBlur:()=>U("heightFeet",p),className:"text-base w-1/2 px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.heightFeet&&!p?"border border-red-500":""),required:!0,children:[(0,n.jsx)("option",{value:"",children:"Feet"}),[...Array(8)].map((e,t)=>(0,n.jsx)("option",{value:t+1,children:t+1},t))]}),(0,n.jsxs)("select",{value:m,onChange:e=>g(e.target.value),onBlur:()=>U("heightInches",m),className:"text-base w-1/2 px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.heightInches&&!m?"border border-red-500":""),required:!0,children:[(0,n.jsx)("option",{value:"",children:"Inches"}),[...Array(12)].map((e,t)=>(0,n.jsx)("option",{value:t,children:t},t))]})]}):(0,n.jsx)("input",{type:"number",placeholder:"Height (cm)",value:b,onChange:e=>f(e.target.value),onBlur:()=>U("heightCm",b),className:"text-base w-full px-3 py-2 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.heightCm&&!b?"border border-red-500":""),required:!0}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Weight"}),"imperial"===d?(0,n.jsx)("input",{type:"number",placeholder:"Weight (lbs)",required:!0,value:w,max:"imperial"===d?999:453,onChange:J,onBlur:()=>U("weight",w),className:"text-base w-full px-3 py-2 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.weight&&!w?"border border-red-500":"")}):(0,n.jsx)("input",{type:"number",placeholder:"Weight (kg)",required:!0,value:w,max:"imperial"===d?999:453,onChange:J,onBlur:()=>U("weight",w),className:"text-base w-full px-3 py-2 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.weight&&!w?"border border-red-500":"")})]}),2===E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-white text-sm",children:"Step 2: Define your goals"}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Experience Level"}),(0,n.jsxs)("select",{required:!0,value:j,onChange:e=>v(e.target.value),onBlur:()=>U("experience",j),className:"text-base w-full px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.experience&&!j?"border border-red-500":""),children:[(0,n.jsx)("option",{value:"",children:"Experience Level"}),(0,n.jsx)("option",{value:"beginner",children:"Beginner"}),(0,n.jsx)("option",{value:"intermediate",children:"Intermediate"}),(0,n.jsx)("option",{value:"advanced",children:"Advanced"})]}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Primary Goal"}),(0,n.jsxs)("select",{required:!0,value:N,onChange:e=>S(e.target.value),onBlur:()=>U("goal",N),className:"text-base w-full px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.goal&&!N?"border border-red-500":""),children:[(0,n.jsx)("option",{value:"",children:"Primary Goal"}),(0,n.jsx)("option",{value:"fat_loss",children:"Fat Loss"}),(0,n.jsx)("option",{value:"muscle_gain",children:"Muscle Gain"}),(0,n.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,n.jsx)("option",{value:"athletic_performance",children:"Athletic Performance"})]})]}),3===E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-white text-sm",children:"Step 3: Workout preferences"}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Days per Week"}),(0,n.jsx)("input",{type:"number",min:"1",max:"7",placeholder:"Days per Week",required:!0,value:k,onChange:e=>{let t=e.target.value;if(""===t){_(""),P([]);return}let r=Number(t);r>=1&&r<=7&&(_(t),P([]))},onBlur:()=>U("daysPerWeek",k),onWheel:e=>e.target.blur(),className:"text-base w-full px-3 py-2 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.daysPerWeek&&!k?"border border-red-500":"")}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Equipment Access"}),(0,n.jsxs)("select",{required:!0,value:C,onChange:e=>F(e.target.value),onBlur:()=>U("equipment",C),className:"text-base w-full px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.equipment&&!C?"border border-red-500":""),children:[(0,n.jsx)("option",{value:"",children:"Equipment Access"}),(0,n.jsx)("option",{value:"full_gym",children:"Full Gym"}),(0,n.jsx)("option",{value:"dumbbells_only",children:"Dumbbells Only"}),(0,n.jsx)("option",{value:"bodyweight_only",children:"Bodyweight Only"})]}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Cardio Preference"}),(0,n.jsxs)("select",{required:!0,value:D,onChange:e=>I(e.target.value),onBlur:()=>U("cardioPreference",D),className:"text-base w-full px-3 py-2 pr-8 rounded-2xl bg-[#242B2F] text-white focus:outline-none ".concat(L.cardioPreference&&!D?"border border-red-500":""),children:[(0,n.jsx)("option",{value:"",children:"Cardio Preference"}),(0,n.jsx)("option",{value:"none",children:"None (Strength Only)"}),(0,n.jsx)("option",{value:"light",children:"Light (Warmups or Finishers)"}),(0,n.jsx)("option",{value:"moderate",children:"Moderate (1â€“2 Sessions/Week)"}),(0,n.jsx)("option",{value:"high",children:"High (Daily Conditioning)"})]}),(0,n.jsx)("label",{className:"block text-sm text-white",children:"Preferred Rest Days"}),(()=>{let e=7-Number(k||0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(t=>(0,n.jsx)("button",{type:"button",className:"px-3 py-1 rounded-full ".concat(B.includes(t.toLowerCase())?"bg-pink-600 text-white":0===e||!B.includes(t.toLowerCase())&&B.length>=e?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-gray-700 text-white"),onClick:()=>P(r=>{let n=t.toLowerCase();return r.includes(n)?r.filter(e=>e!==n):r.length>=e?[...r.slice(1),n]:[...r,n]}),disabled:0===e||!B.includes(t.toLowerCase())&&B.length>=e,children:t},t))}),(0,n.jsxs)("p",{className:"text-gray-400 text-xs",children:["Select up to ",e," rest day",1!==e?"s":""]})]})})()]}),4===E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-white text-sm mb-2",children:"Step 4: Review your selections"}),(0,n.jsxs)("div",{className:"text-white text-sm space-y-2",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Name:"})," ",W]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Date of Birth:"})," ",r?(0,o.KG)(r,{month:"long",day:"numeric",includeYear:!0}):""]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Preferred Units:"})," ","imperial"===d?"Imperial (lbs/ft)":"Metric (kg/cm)"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Height:"})," ","imperial"===d?"".concat(p,"'").concat(m,'"'):"".concat(b," cm")]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Weight:"})," ",w," ","imperial"===d?"lbs":"kg"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Experience:"})," ",j]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Goal:"})," ",{fat_loss:"Fat Loss",muscle_gain:"Muscle Gain",maintenance:"Maintenance",athletic_performance:"Athletic Performance"}[N]]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Days per Week:"})," ",k]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Equipment:"})," ",{full_gym:"Full Gym",dumbbells_only:"Dumbbells Only",bodyweight_only:"Bodyweight Only"}[C]]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Cardio Preference:"})," ",{none:"None (Strength Only)",light:"Light (Warmups or Finishers)",moderate:"Moderate (1â€“2 Sessions/Week)",high:"High (Daily Conditioning)"}[D]]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Preferred Rest Days:"})," ",B.length?B.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", "):"None"]})]})]}),(0,n.jsxs)("div",{className:"flex justify-between pt-4",children:[E>1&&(0,n.jsx)("button",{type:"button",onClick:()=>A(E-1),className:"px-4 py-2 rounded-2xl bg-[#555] text-white",children:"Back"}),E<4?(0,n.jsx)("button",{type:"button",onClick:()=>{G(e=>{let t={...e};return 1===E?(t.name=!0,t.dob=!0,t.unitSystem=!0,"imperial"===d?(t.heightFeet=!0,t.heightInches=!0):t.heightCm=!0,t.weight=!0):2===E?(t.experience=!0,t.goal=!0):3===E&&(t.daysPerWeek=!0,t.equipment=!0,t.cardioPreference=!0),t}),H()&&A(E+1)},disabled:!H(),className:"px-4 py-2 rounded-2xl text-white ".concat(H()?"bg-gradient-to-r from-pink-500 to-pink-700":"bg-gray-600 cursor-not-allowed"),children:"Next"}):(0,n.jsx)("button",{type:"button",onClick:Y,disabled:M,className:"px-4 py-2 rounded-2xl bg-gradient-to-r from-pink-500 to-pink-700 text-white",children:M?"Setting upâ€¦":"Get Started"})]})]})})}function h(){return(0,n.jsx)(d,{})}},95183:(e,t,r)=>{Promise.resolve().then(r.bind(r,84635))}},e=>{var t=t=>e(e.s=t);e.O(0,[851,441,684,358],()=>t(95183)),_N_E=e.O()}]);