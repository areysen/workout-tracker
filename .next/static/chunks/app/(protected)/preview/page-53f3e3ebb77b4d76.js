(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{13346:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(95155);r(12115);var o=r(35695);function a(e){let{fallback:t="/",label:r="← Back",to:a}=e,n=(0,o.useRouter)();return(0,s.jsx)("button",{onClick:()=>{a?n.push(a):n.back()},className:"px-3 py-1 bg-gradient-to-r from-pink-500 to-pink-700 text-white rounded-2xl shadow-glow hover:shadow-glow-hover transition duration-300 text-sm",children:r})}},19433:(e,t,r)=>{"use strict";function s(){let e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(s)}function o(e){let t;if("string"==typeof e){let[r,s,o]=e.split("-").map(Number);t=new Date(r,s-1,o)}else t=e instanceof Date?e:new Date(e);return t.toLocaleDateString("en-US",{weekday:"long"})}function a(e){return new Date(e).toISOString().split("T")[0]}function n(e){let t,{weekday:r="short",month:s="short",day:o="numeric",includeYear:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){let[r,s,o]=e.split("-").map(Number);t=new Date(r,s-1,o)}else if(e instanceof Date)t=e;else throw Error("Invalid date input passed to formatDateWithOptions");return t.toLocaleDateString("en-US",{weekday:r,month:s,day:o,...a&&{year:"numeric"}})}r.d(t,{Gq:()=>s,KG:()=>n,VJ:()=>o,hi:()=>a})},30954:(e,t,r)=>{Promise.resolve().then(r.bind(r,85912))},35695:(e,t,r)=>{"use strict";var s=r(18999);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},42827:(e,t,r)=>{"use strict";r.d(t,{ToastProvider:()=>n,d:()=>i});var s=r(95155),o=r(12115);let a=(0,o.createContext)();function n(e){let{children:t}=e,[r,n]=(0,o.useState)(""),[i,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[u,p]=(0,o.useState)(null),[m,h]=(0,o.useState)("success");return(0,o.useEffect)(()=>{let e;return i&&(e=setTimeout(()=>{l(!1),n(""),d(!1),p(null)},5e3)),()=>clearTimeout(e)},[i,r]),(0,s.jsx)(a.Provider,{value:{message:r,visible:i,toastType:m,showToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};h(t),n(e),l(!0),d(r.showUndo||!1),p(()=>r.onUndo||null)},hideToast:()=>{l(!1),n("")},showUndo:c,onUndo:u},children:t})}function i(){return(0,o.useContext)(a)}},46012:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(95155);function o(e){let{isOpen:t,message:r,onConfirm:o,onCancel:a}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-gradient-to-br from-pink-500 to-pink-700 p-6 rounded-lg shadow-lg max-w-sm w-full text-center border border-pink-400",children:[(0,s.jsx)("h2",{className:"text-white text-2xl font-extrabold mb-4",children:r}),(0,s.jsxs)("div",{className:"flex gap-4 justify-center mt-6",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 rounded border border-white text-white font-bold hover:bg-white hover:text-[#242B2F] transition",children:"Cancel"}),(0,s.jsx)("button",{onClick:o,className:"px-4 py-2 rounded bg-red-500 hover:bg-red-600 text-white font-bold transition",children:"Confirm"})]})]})}):null}r(12115)},63233:(e,t,r)=>{"use strict";r.d(t,{DP:()=>o,JI:()=>n,LJ:()=>a,sA:()=>i,supabase:()=>s});let s=(0,r(10851).UU)("https://yfnbnytutxdbmyvfsyba.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbmJueXR1dHhkYm15dmZzeWJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ5MjAwNTksImV4cCI6MjA2MDQ5NjA1OX0.HJhDpx79rDzl5DZIh3qJZbBrSwudG95htPXOs2IGD30",{auth:{persistSession:!0,detectSessionInUrl:!0}}),o=async()=>{let{data:e,error:t}=await s.from("workout_logs").select("*").order("date",{ascending:!0});return t?(console.error("Error fetching workout logs:",t.message),[]):e},a=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,{data:t,error:r}=await s.from("workout_logs").select("date, skipped").order("date",{ascending:!1}).limit(e);return r?(console.error("Error fetching workout logs for last N days:",r.message),[]):t},n=e=>{let t=0;for(let r of e){if(r.skipped)break;t++}return t},i=e=>{let t=0,r=0;for(let s of e)s.skipped?(r>t&&(t=r),r=0):r++;return r>t&&(t=r),t}},75342:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(35695);function o(e){let{param:t,fallback:r,onResult:o}=e,a=(0,s.useSearchParams)().get(t)||r;return o&&o(a),null}},85912:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x,dynamic:()=>m});var s=r(95155),o=r(35695),a=r(12115),n=r(75342),i=r(36545),l=r(63233),c=r(19433),d=r(13346),u=r(42827),p=r(46012);let m="force-dynamic";function h(e){let{date:t,today:r,logForDate:o,setLogForDate:n,loading:u,setLoading:m,showToast:h,showConfirmSkip:x,setShowConfirmSkip:w,todaySkipped:f,setTodaySkipped:g,todayHasLog:b,setTodayHasLog:k,forecastTemplateId:y,setForecastTemplateId:v,router:j}=e;(0,a.useEffect)(()=>{!async function(){m(!0),v(null);let{data:e,error:r}=await l.supabase.from("workout_logs").select("*").eq("date",t).maybeSingle();if(r&&console.error("Error fetching log:",r),e){var s;if("string"==typeof e.exercises)try{e.exercises=JSON.parse(e.exercises)}catch(t){console.error("❌ Failed to parse exercises",t),e.exercises={warmup:[],main:[],cooldown:[]}}(null==(s=e.exercises)?void 0:s.main)||(e.exercises={warmup:[],main:Array.isArray(e.exercises)?e.exercises:[],cooldown:[]}),n(e),v(null)}else{let e=(0,c.VJ)(t).toLowerCase(),{data:r,error:s}=await l.supabase.from("workout_templates").select("*").eq("day_of_week",e);if(r&&r.length>0){let e=r[0],s=e.exercises;if("string"==typeof s)try{s=JSON.parse(s)}catch(e){console.error("❌ Failed to parse template exercises",e),s={}}n({date:t,exercises:{warmup:(null==s?void 0:s.warmup)||[],main:(null==s?void 0:s.main)||[],cooldown:(null==s?void 0:s.cooldown)||[]},muscle_group:e.workout_name,hasLoggedWorkout:!1}),v(e.id)}else n(null)}setTimeout(()=>{m(!1)},250)}()},[t,m,n,v]),(0,a.useEffect)(()=>{!async function(){let{data:e,error:t}=await l.supabase.from("workout_logs").select("skipped").eq("date",r).maybeSingle();!t&&e?(g(!!e.skipped),k(!0)):(g(!1),k(!1))}()},[r,g,k]);let[S,N]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{let e=()=>{window.scrollY>10?N(!0):N(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(null==o?void 0:o.date)&&(0,c.KG)(o.date,{weekday:"long"}),u)?(0,s.jsx)("div",{className:"min-h-screen bg-[#242B2F] text-white flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-pink-400"})}):(0,s.jsxs)("div",{className:"min-h-screen bg-[#242B2F] text-white p-4 max-w-3xl mx-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 z-10 bg-[#242B2F] pb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center flex-wrap gap-3",children:[(0,s.jsx)(d.A,{}),(0,s.jsxs)("h1",{className:"text-3xl font-bold mb-1",children:["Preview for ",(0,c.KG)(t)]})]}),t===r&&(0,s.jsx)(i.P.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,ease:"easeOut"},className:"text-center bg-gradient-to-r from-pink-500 to-pink-700 text-white py-4 px-6 rounded-2xl mt-2 shadow-glow border border-pink-400 hover:shadow-glow-hover",children:"⚡ Ready to Crush Your Workout? Preview Your Plan!"})]}),(0,s.jsx)("div",{className:"pb-52",children:(0,s.jsxs)("div",{className:"space-y-3",children:[o&&(0,s.jsxs)("h2",{className:"text-xl font-semibold text-pink-400 mb-4",children:[(0,c.VJ)(t),o.muscle_group?" — ".concat(o.muscle_group):""]}),(null==o?void 0:o.exercises)&&["warmup","main","cooldown"].map(e=>{var t,r;return(null==(r=o.exercises)||null==(t=r[e])?void 0:t.length)>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white capitalize mb-2",children:e}),(0,s.jsx)("ul",{className:"text-sm space-y-2",children:o.exercises[e].map((t,r)=>(0,s.jsxs)("li",{className:"bg-gradient-to-br from-[#2E353A] to-[#343E44] border border-[#C63663] p-3 rounded",children:[(0,s.jsx)("p",{className:"font-semibold text-white",children:t.name}),(0,s.jsxs)("p",{className:"text-gray-300 text-xs",children:[t.sets&&"Sets: ".concat(t.sets," "),t.reps&&"Reps: ".concat(t.reps," "),t.weighted&&t.weight&&"Weight: ".concat(t.weight," lbs "),t.rpe&&"RPE: ".concat(t.rpe," "),t.rounds&&"Rounds: ".concat(t.rounds," "),t.work&&"Work: ".concat(t.work," "),t.rest&&"Rest: ".concat(t.rest," "),t.timed&&t.duration&&"Duration: ".concat(t.duration," "),t.cardio&&(0,s.jsx)("span",{className:"ml-1 text-[#6EE7B7]",children:"Cardio"})]}),t.notes&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Note: ",t.notes]})]},"".concat(e,"-").concat(r)))})]},e)})]})}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"pb-52"}),(0,s.jsxs)("div",{className:"fixed bottom-0 left-0 w-full bg-[#242B2F] p-4 space-y-3 z-10 max-w-3xl mx-auto",children:[(0,s.jsx)("button",{onClick:()=>{(null==o?void 0:o.id)?j.push("/log-workout?fromPreview=true"):y&&j.push("/log-workout?templateId=".concat(y,"&fromPreview=true"))},className:"w-full bg-gradient-to-r from-pink-500 to-pink-700 text-white font-bold py-2 px-4 rounded-2xl shadow-glow hover:shadow-glow-hover transition duration-300 text-center",children:"Start Workout"}),f||b?f?(0,s.jsx)("button",{disabled:!0,className:"w-full bg-gradient-to-br from-gray-700 to-gray-600 text-white font-bold py-2 px-4 rounded-2xl border border-pink-400 shadow-glow cursor-not-allowed text-center",children:"Skipped"}):b?(0,s.jsx)("button",{disabled:!0,className:"w-full bg-gradient-to-br from-gray-700 to-gray-600 text-white font-bold py-2 px-4 rounded-2xl border border-pink-400 shadow-glow cursor-not-allowed text-center",children:"Logged for Today"}):null:(0,s.jsx)("button",{onClick:()=>w(!0),className:"w-full bg-gradient-to-br from-pink-600 to-red-600 text-white font-bold py-2 px-4 rounded-2xl shadow-glow hover:shadow-glow-hover transition duration-300 text-center",children:"Skip Today"})]})]}),(0,s.jsx)(p.A,{isOpen:x,message:"Are you sure you want to skip this workout?",onCancel:()=>w(!1),onConfirm:async()=>{w(!1);let{error:e}=await l.supabase.from("workout_logs").insert([{date:r,forecast:!1,skipped:!0,muscle_group:(null==o?void 0:o.muscle_group)||"",day:(0,c.VJ)(r)}]);e?(console.error("Error skipping workout:",e),h("Failed to skip workout. Please try again.","error")):(g(!0),j.replace("/mission-complete?type=skipped"))}})]})}let x=function(){let e=(0,o.useRouter)(),[t,r]=(0,a.useState)(null),i=(0,c.Gq)(),[l,d]=(0,a.useState)(null),[p,m]=(0,a.useState)(!0),{showToast:x}=(0,u.d)(),[w,f]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),[k,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(null);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Suspense,{fallback:null,children:(0,s.jsx)(n.A,{param:"date",onResult:r})}),t&&(0,s.jsx)(h,{date:t,today:i,logForDate:l,setLogForDate:d,loading:p,setLoading:m,showToast:x,showConfirmSkip:w,setShowConfirmSkip:f,todaySkipped:g,setTodaySkipped:b,todayHasLog:k,setTodayHasLog:y,forecastTemplateId:v,setForecastTemplateId:j,router:e})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[851,545,441,684,358],()=>t(30954)),_N_E=e.O()}]);